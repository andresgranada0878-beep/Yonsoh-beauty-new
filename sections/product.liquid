{% comment %}
  This section is used in the product template to render product page with
  media, content, and add-to-cart form.

  https://shopify.dev/docs/storefronts/themes/architecture/templates/product
{% endcomment %}

<!-- DIAGN√ìSTICO: Informaci√≥n del producto -->
<div style="background: #f0f0f0; padding: 20px; margin: 20px 0; border: 2px solid #333;">
  <h3>üîç DIAGN√ìSTICO DEL PRODUCTO</h3>
  <p><strong>T√≠tulo:</strong> {{ product.title }}</p>
  <p><strong>Precio:</strong> {{ product.price | money }}</p>
  <p><strong>Disponible:</strong> {{ product.available }}</p>
  <p><strong>Variantes:</strong> {{ product.variants.size }}</p>
  <p><strong>Descripci√≥n:</strong> {{ product.description | truncate: 100 }}</p>
  <p><strong>ID del producto:</strong> {{ product.id }}</p>
  <p><strong>URL:</strong> {{ product.url }}</p>
</div>

<div class="product-images">
  <h3>üì∏ IM√ÅGENES DEL PRODUCTO</h3>
  {% for image in product.images %}
    <div style="border: 1px solid #ccc; margin: 10px 0; padding: 10px;">
      <p><strong>Imagen {{ forloop.index }}:</strong></p>
      <img src="{{ image | image_url: width: 400 }}" alt="{{ image.alt | escape }}" style="max-width: 100%; height: auto;">
    </div>
  {% endfor %}
</div>

<div class="product-info" style="background: #e8f4f8; padding: 20px; margin: 20px 0;">
  <h3>üìã INFORMACI√ìN DEL PRODUCTO</h3>
  <h1>{{ product.title }}</h1>
  <p><strong>Precio:</strong> {{ product.price | money }}</p>
  <p><strong>Descripci√≥n:</strong></p>
  <p>{{ product.description }}</p>
</div>

<div class="product-form" style="background: #fff3cd; padding: 20px; margin: 20px 0; border: 2px solid #ffc107;">
  <h3>üõí FORMULARIO DE COMPRA</h3>
  
  {% if product.available %}
    <p style="color: green;">‚úÖ Producto disponible para compra</p>
    
    <form action="/cart/add" method="post" enctype="multipart/form-data">
      {% assign current_variant = product.selected_or_first_available_variant %}
      
      <div style="margin: 15px 0;">
        <label><strong>Variante:</strong></label>
        <select name="id" style="width: 100%; padding: 10px; margin: 5px 0;">
          {% for variant in product.variants %}
            <option
              value="{{ variant.id }}"
              {% if variant == current_variant %}
                selected="selected"
              {% endif %}
            >
              {{ variant.title }} - {{ variant.price | money }}
            </option>
          {% endfor %}
        </select>
      </div>

      <div style="margin: 15px 0;">
        <label><strong>Cantidad:</strong></label>
        <input type="number" name="quantity" min="1" value="1" style="width: 100px; padding: 10px;">
      </div>

      <div class="product-buttons" style="margin: 20px 0;">
        <!-- Bot√≥n de agregar al carrito -->
        <button type="submit" name="add" style="background: #007cba; color: white; padding: 15px 30px; border: none; border-radius: 4px; cursor: pointer; font-size: 16px; margin: 10px 0; width: 100%;">
          üõí Agregar al Carrito
        </button>
      </div>
    </form>
    
    <!-- Formulario separado para el bot√≥n de pago din√°mico -->
    <div style="margin: 15px 0;">
      <p><strong>Bot√≥n de pago din√°mico:</strong></p>
      {% form 'product', product %}
        {{ form | payment_button }}
      {% endform %}
    </div>
    
  {% else %}
    <p style="color: red; font-weight: bold;">‚ùå Este producto no est√° disponible actualmente.</p>
  {% endif %}
</div>

<!-- DIAGN√ìSTICO: Informaci√≥n de la tienda -->
<div style="background: #d1ecf1; padding: 20px; margin: 20px 0; border: 2px solid #17a2b8;">
  <h3>üè™ INFORMACI√ìN DE LA TIENDA</h3>
  <p><strong>Nombre de la tienda:</strong> {{ shop.name }}</p>
  <p><strong>M√©todos de pago habilitados:</strong> {{ shop.enabled_payment_types.size }}</p>
  <p><strong>URL de la tienda:</strong> {{ shop.url }}</p>
</div>

{% stylesheet %}
  .product-form {
    margin-top: 20px;
  }
  
  .product-buttons {
    display: flex;
    flex-direction: column;
    gap: 10px;
    margin-top: 15px;
  }
  
  /* Asegurar que los botones de pago din√°mico se muestren correctamente */
  shopify-payment-button {
    width: 100%;
  }
{% endstylesheet %}

{% schema %}
{
  "name": "t:general.product",
  "settings": [],
  "disabled_on": {
    "groups": ["header", "footer"]
  }
}
{% endschema %}
